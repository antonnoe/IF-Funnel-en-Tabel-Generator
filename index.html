<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Infofrankrijk Funnel Manager v21</title>
<style>
    /* --- ADMIN DASHBOARD STYLING --- */
    body { font-family: 'Segoe UI', system-ui, sans-serif; background: #f4f6f8; margin: 0; padding: 20px; color: #333; }
    .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); overflow: hidden; min-height: 80vh; }
    
    header { background: #800000; color: white; padding: 20px 30px; display: flex; justify-content: space-between; align-items: center; }
    h1 { margin: 0; font-size: 1.4em; }
    .version { font-size: 0.8em; opacity: 0.8; background: rgba(255,255,255,0.2); padding: 2px 8px; border-radius: 4px; }

    /* Tabs */
    .tabs { display: flex; background: #eee; border-bottom: 1px solid #ddd; }
    .tab { padding: 15px 20px; cursor: pointer; font-weight: bold; border: none; background: none; color: #555; outline: none; transition: 0.2s; border-right: 1px solid #ddd;}
    .tab.active { background: white; color: #800000; border-top: 4px solid #800000; }
    .tab:hover:not(.active) { background: #e0e0e0; }
    .tab-content { padding: 30px; display: none; }
    .tab-content.active { display: block; animation: fadeIn 0.3s; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

    /* Forms */
    .panel { background: #f8f9fa; border: 1px solid #e9ecef; padding: 20px; border-radius: 6px; margin-bottom: 20px; }
    .form-row { display: flex; gap: 15px; margin-bottom: 15px; flex-wrap: wrap;}
    .form-group { flex: 1; min-width: 250px; }
    label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 0.85em; color: #666; text-transform: uppercase; }
    input[type="text"], textarea, select { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-size: 1em; }
    textarea { height: 120px; resize: vertical; font-family: 'Segoe UI', sans-serif; }

    /* Editor Toolbar */
    .editor-toolbar { background: #e9ecef; padding: 5px; border: 1px solid #ccc; border-bottom: none; border-radius: 4px 4px 0 0; display: flex; gap: 5px; }
    .editor-btn { background: white; border: 1px solid #ccc; padding: 2px 8px; cursor: pointer; font-weight: bold; font-size: 0.9em; border-radius: 3px; }
    .editor-btn:hover { background: #ddd; }
    #tileText { border-radius: 0 0 4px 4px; margin-top:0; }

    /* Buttons */
    .btn { padding: 10px 18px; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; transition: 0.2s; font-size: 0.95em; display: inline-flex; align-items: center; justify-content: center; gap: 5px; text-decoration: none; }
    .btn-primary { background: #800000; color: white; }
    .btn-primary:hover { background: #600000; transform: translateY(-1px); }
    .btn-success { background: #27ae60; color: white; width: 100%; font-size: 1.1em; padding: 15px; }
    .btn-success:hover { background: #219150; }
    .btn-danger { background: #fee2e2; color: #c53030; padding: 6px 12px; font-size: 0.85em; }
    .btn-danger:hover { background: #fecaca; }
    .btn-action { background: #e2e8f0; color: #4a5568; padding: 6px 10px; }
    .btn-action:hover { background: #cbd5e0; }
    
    .btn-keep { background: #fff; color: #333; border: 2px solid #f1c40f; width: 100%; padding: 15px; margin-bottom: 20px; font-size: 1.1em; transition:0.2s;}
    .btn-keep:hover { background: #fff9c4; border-color: #f39c12; transform: translateY(-1px); box-shadow: 0 2px 5px rgba(0,0,0,0.1); }

    .output-options { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px; }
    .btn-opt { padding: 20px; font-size: 1.1em; border: 2px solid transparent; color: white; }
    .btn-opt:hover { transform: translateY(-2px); box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    .opt-all { background: #27ae60; }
    .opt-tiles { background: #2980b9; }
    .opt-table { background: #e67e22; }

    /* Toast Notification */
    #toast {
        visibility: hidden; min-width: 250px; margin-left: -125px; background-color: #333; color: #fff; text-align: center; border-radius: 4px; padding: 16px; position: fixed; z-index: 1000; left: 50%; bottom: 30px; font-size: 17px; box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }
    #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }
    #toast.success { background-color: #27ae60; }
    @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
    @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }

    /* Admin Previews */
    .tile-grid-preview { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; }
    .tile-card { background: white; border: 1px solid #ddd; border-radius: 6px; overflow: hidden; display: flex; flex-direction: column; position: relative; }
    .tile-card:hover { border-color: #800000; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .edit-hint { position: absolute; top: 5px; right: 5px; background: rgba(255,255,255,0.9); padding: 2px 6px; font-size: 0.7em; border-radius: 3px; border: 1px solid #ccc; pointer-events: none; color: #333;}
    .tile-img { height: 160px; background-color: #eee; background-size: cover; background-position: top center; border-bottom: 1px solid #eee; }
    .tile-body { padding: 15px; flex: 1; display: flex; flex-direction: column; background: rgba(128, 0, 0, 0.04); }
    .tile-title { font-weight: bold; color: #800000; margin-bottom: 5px; font-size: 1.1em; }
    .tile-text { font-size: 0.95em; color: #555; flex: 1; margin-bottom: 15px; line-height: 1.4; white-space: pre-line; max-height: 100px; overflow-y: auto;}

    .table-preview { width: 100%; border-collapse: collapse; background: white; font-size: 0.9em; }
    .table-preview th { text-align: left; background: #f1f5f9; padding: 12px; border-bottom: 2px solid #e2e8f0; color: #475569; }
    .table-preview td { padding: 10px 12px; border-bottom: 1px solid #f1f5f9; vertical-align: middle; }
    .table-header-row td { background: #fff1f2; color: #800000; font-weight: bold; text-transform: uppercase; font-size: 0.85em; letter-spacing: 1px; }
    .check-yes { color: #27ae60; font-weight: bold; }
    .check-no { color: #cbd5e0; }

    /* Backup Area Styles */
    .backup-container { background: #2d3748; padding: 25px; border-radius: 6px; color: white; }
    .backup-textarea { width: 100%; height: 100px; background: #1a202c; color: #a0aec0; border: 1px solid #4a5568; padding: 10px; font-family: monospace; border-radius: 4px; box-sizing: border-box; margin: 5px 0; }
    
    .fail-safe-box {
        background: #fff3cd; 
        color: #856404; 
        border: 2px solid #ffeeba; 
        padding: 15px; 
        border-radius: 6px; 
        margin-bottom: 25px;
        display: flex;
        align-items: center;
        gap: 15px;
    }
    .fail-safe-icon { font-size: 2em; }
</style>
</head>
<body>

<div class="container">
    <header>
        <h1>Infofrankrijk Funnel Manager</h1>
        <div class="version">v21 Fail-Safe</div>
    </header>

    <div class="tabs">
        <button class="tab active" onclick="switchTab('backup')">1. START & BACKUP</button>
        <button class="tab" onclick="switchTab('tiles')">2. De Tegels (Vitrine)</button>
        <button class="tab" onclick="switchTab('table')">3. De Tabel (Vergelijking)</button>
        <button class="tab" onclick="switchTab('code')">4. KASSA (Code)</button>
    </div>

    <div id="tab-backup" class="tab-content active">
        
        <div class="fail-safe-box">
            <div class="fail-safe-icon">‚ö†Ô∏è</div>
            <div>
                <strong>BELANGRIJK VOOR BEHEERDERS:</strong><br>
                Heb je wijzigingen gedaan? Sla ze <strong>ALTIJD</strong> op in Google Keep.<br>
                Als je dit venster sluit zonder op te slaan in Keep, is je werk weg.
            </div>
        </div>

        <div class="backup-container">
            <a href="https://keep.google.com/#NOTE/19zNWkbyH7Ou878ICDUN6DQjTCJzadyE7LvUlsKwnqtnnE7Jwt-31gtf7u0CyZskj" target="_blank" class="btn btn-keep">
                üìù 1. KLIK HIER: Open Google Keep Notitie
            </a>

            <div style="display:flex; gap: 20px; flex-wrap: wrap;">
                <div style="flex:1;">
                    <label style="color:#f1c40f; font-weight:bold;">2. KLAAR? OPSLAAN!</label>
                    <p style="font-size:0.8em; margin-top:0; color:#ccc;">Kopieer dit blok en plak het in Keep (overschrijf de oude).</p>
                    <textarea id="exportArea" class="backup-textarea" readonly onclick="this.select()"></textarea>
                    <button class="btn btn-primary" onclick="copyExport()">Kopieer naar klembord</button>
                </div>
                <div style="flex:1;">
                    <label style="color:#27ae60; font-weight:bold;">3. BEGINNEN? INLADEN!</label>
                    <p style="font-size:0.8em; margin-top:0; color:#ccc;">Plak hier de code uit Keep om verder te werken.</p>
                    <textarea id="importArea" class="backup-textarea" placeholder="Plak hier je JSON code..."></textarea>
                    <button class="btn btn-primary" style="background:#f39c12;" onclick="importData()">Data Inladen</button>
                </div>
            </div>
            
            <div style="margin-top: 30px; text-align:right; border-top: 1px solid #4a5568; padding-top: 15px;">
                <button class="btn btn-danger" onclick="resetToDefault()">Noodgeval: Reset naar 'Gouden Master'</button>
            </div>
        </div>
    </div>

    <div id="tab-tiles" class="tab-content">
        <div class="panel">
            <h3>Tegel Bewerken / Toevoegen</h3>
            <div class="form-row">
                <div class="form-group">
                    <label>Titel</label>
                    <input type="text" id="tileTitle" placeholder="Bijv. Bruto-Netto Calculator">
                </div>
                <div class="form-group">
                    <label>Afbeelding URL</label>
                    <input type="text" id="tileImg" placeholder="https://infofrankrijk.com/...">
                </div>
            </div>
            <div class="form-group">
                <label>Tekst (Wervend)</label>
                <div class="editor-toolbar">
                    <button class="editor-btn" onclick="formatText('bold')" title="Dikgedrukt">B</button>
                    <button class="editor-btn" onclick="formatText('italic')" title="Schuingedrukt">I</button>
                    <button class="editor-btn" onclick="formatText('list')" title="Opsomming">‚Ä¢ Lijst</button>
                </div>
                <textarea id="tileText" placeholder="Beschrijf de tool... Gebruik Enter voor nieuwe regels."></textarea>
            </div>
            <button class="btn btn-primary" onclick="addTile()">+ Opslaan / Toevoegen</button>
        </div>
        <div id="tileList" class="tile-grid-preview"></div>
    </div>

    <div id="tab-table" class="tab-content">
        <div class="panel">
            <h3>Regel Toevoegen</h3>
            <div class="form-row">
                <div class="form-group" style="flex: 0 0 150px;">
                    <label>Type</label>
                    <select id="rowType">
                        <option value="item">Dienst / Tool</option>
                        <option value="header">Tussenkop</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Naam / Omschrijving</label>
                    <input type="text" id="rowName" placeholder="Omschrijving van de dienst">
                </div>
                <div class="form-group">
                    <label>Link URL (Optioneel)</label>
                    <input type="text" id="rowLink" placeholder="https://...">
                </div>
            </div>
            <div style="margin-bottom: 15px;">
                <label style="display:inline-block; margin-right: 20px; cursor:pointer;">
                    <input type="checkbox" id="visCheck"> Toegankelijk voor Bezoeker?
                </label>
                <label style="display:inline-block; cursor:pointer;">
                    <input type="checkbox" id="subCheck" checked> Toegankelijk voor Abonnee?
                </label>
            </div>
            <button class="btn btn-primary" onclick="addTableRow()">+ Toevoegen aan Tabel</button>
        </div>
        <table class="table-preview">
            <thead><tr><th>Item</th><th width="50" style="text-align:center">Bez</th><th width="50" style="text-align:center">Abo</th><th width="120" style="text-align:center">Actie</th></tr></thead>
            <tbody id="tableList"></tbody>
        </table>
    </div>

    <div id="tab-code" class="tab-content">
        <div style="text-align:center; max-width: 800px; margin: 0 auto;">
            <h2 style="color:#333; margin-bottom: 20px;">Wat wil je publiceren?</h2>
            
            <div class="output-options">
                <button class="btn btn-opt opt-all" onclick="generateCode('all')">
                    <strong>üì¶ ALLES (Funnel)</strong><br>
                    <span style="font-size:0.8em; opacity:0.8">Tegels + Tabel + Uitklap</span>
                </button>
                
                <button class="btn btn-opt opt-tiles" onclick="generateCode('tiles')">
                    <strong>üñºÔ∏è ALLEEN TEGELS</strong><br>
                    <span style="font-size:0.8em; opacity:0.8">Het grid met plaatjes</span>
                </button>
                
                <button class="btn btn-opt opt-table" onclick="generateCode('table')">
                    <strong>üìä ALLEEN TABEL</strong><br>
                    <span style="font-size:0.8em; opacity:0.8">De vergelijking</span>
                </button>
            </div>

            <p style="color:#666; margin-bottom: 10px; font-style:italic;">Enters worden nu correct omgezet naar witregels.</p>
        </div>
        <textarea id="finalCode" style="width:100%; height:300px; margin-top:10px; border:1px solid #ddd; padding:15px; font-family:monospace; color:#555;" readonly onclick="this.select()"></textarea>
    </div>
</div>

<div id="toast">Melding</div>

<script>
/* ======================================================
   FAIL-SAFE DEFAULT DATA (De 'Gouden Master' uit Keep)
   ====================================================== */
const defaultData = {"tiles":[{"title":"Beroepseisen checker","img":"https://infofrankrijk.tempurl.host/wp-content/uploads/2025/12/beroepengids-scaled.png","text":"We hebben inmiddels meer dan 60 beroepen en ondernemersactiviteiten in dit handige overzicht geplaatst. In √©√©n enkel instrument vind je: \n\n‚Ä¢ alle beroepseisen, \n\n‚Ä¢ benodigde diploma's, \n\n‚Ä¢ bij welke \"Chambre\" aanmelden \n\n‚Ä¢ zelfs een prognose van inkomstenpotentieel. \n\nDe basis is een dynamische koppeling met de Franse overheid waardoor deze tool altijd up to date is. In 2026 zullen we de checker uitbreiden met meer beroepen en sectoren voor ondernemers. "},{"title":"Contr√¥le Technique | APK","img":"https://infofrankrijk.tempurl.host/wp-content/uploads/2025/12/apk-keuring-poctcoe-scaled.png","text":"<b>Voer je postcode in Frankrijk in en:</b>\n\n‚Ä¢ Zie direct waar je de Contr√¥le Technique uit kunt laten voeren. \n‚Ä¢ Met een prijsvergelijker. \n\nVanaf 2026 voegen we actuele benzineprijs- en tankstationdata toe aan deze bestaande APK-keuringsstations-tool, zodat u met √©√©n klik het goedkoopste station in uw departement kunt vinden."},{"title":"Kosten van de vastgoedtransactie","img":"https://infofrankrijk.tempurl.host/wp-content/uploads/2025/12/transactiekosten-vastgoed.png","text":"<b>Deze slimme simulator berekent de totale kosten van een vastgoedtransactie:</b>\n\n‚Ä¢ de notariskosten, \n‚Ä¢ de eventuele makelaarskosten\nen de facultative kosten zoals:\n\n‚Ä¢ de mainlev√©e d'hypoth√®que, \n‚Ä¢ SPANC-assainissement, \n‚Ä¢ de g√©om√®tre \n‚Ä¢ en de hypotheekgarantie (caution). \n\nDeze totale kosten voor zowel de verkoper als de koper <b>kunnen</b> fors oplopen. Zeker als het een tweede woning is en het huis wordt binnen - zeg - tien jaar weer verkocht. "},{"title":"Calculator voor energiekosten","img":"https://infofrankrijk.tempurl.host/wp-content/uploads/2025/12/energiecalculator-scaled.png","text":"Praktische scenariocalculator met ge√Øntegreerde berekeningen voor isolatie, ventilatie, verwarmingssystemen,\nzonnepanelen, zwembad en Franse klimaatzones.\n\n<b>Unieke waardepropositie</b>\n\n‚Ä¢ Combineert fysisch onderbouwde transmissie- en ventilatieverliezen met rendementsscenario‚Äôs (SCOP/COP), bijverwarming en zwembadgebruik. \n‚Ä¢ Energietarieven zijn volledig door u instelbaar ‚Äì geen theoretische aannames, maar praktische vergelijkingen in kWh en kosten.\n‚Ä¢ Live-feeds & bronintegriteit.\n\n<b>Rekendefaults updaten periodiek via open-data-synchronisatie:</b>\n\n‚Ä¢ Zonne-instraling per Franse klimaatzone, realistische SCOP-ranges voor gangbare warmtepompsystemen en zwembadseizoen- & verliesparameters (incl. afdekking en windfactoren), gebaseerd op publieke normlogica zoals EN-ISO-warmteoverdracht en graaddagen-principes.\n‚Ä¢ Vergelijk hoofd- vs. bijverwarming op jaarbasis (kWh / L / kg / ‚Ç¨), incl. COP-dip bij vorst.\n‚Ä¢ Automatische PV-verrekening met 70% eigen verbruik als transparant startpunt.\n‚Ä¢ Zwembadscenario‚Äôs met afdekking- & windfactoren (WP, gas of elektra).\n‚Ä¢ Hoge nauwkeurigheid met echte invoer: U-waarden, ACH, volume, SCOP, energietarieven.\n\nDoelgroep: woningeigenaren in Frankrijk die installaties, renovatieprioriteit en terugverdientijd nuchter willen doorrekenen v√≥√≥r offertes en systeemkeuzes."},{"title":"Plus Value Calculator","img":"https://infofrankrijk.tempurl.host/wp-content/uploads/2025/12/plusvalue-calculator.png","text":"Bereken Franse vastgoedwinstbelasting (Plus-Value Immobili√®re) snel en exact.\nInclusief afschrijvingsvoordeel, forfait-opties en uitsplitsing per jaartal.\n\n<b>Direct PDF-export voor uw dossier.</b>"},{"title":"Klus- en forum-archief","img":"https://infofrankrijk.tempurl.host/wp-content/uploads/2025/12/klussen-in-frankrijk.png","text":"<b>Het hele klusforum van Infofrankrijk in √©√©n scherm? </b>\nJa hoor, het kan wel. Meer dan 12 jaar aan zeer uitgebreide en deskundige bijdragen van de forumdeelnemers van Infofrankrijk worden hier inzichtelijk gemaakt. \n\nDeze module is trouwens <b>gratis</b>, ook als je geen abonnee bent kun je hier gebruik van maken. \n\nVerder gaan we in 2026 de inhoud van de rubriek <b>\"Klussen in Frankrijk\"</b> nog completer maken en zoveel mogelijk in haar oude fantastische staat herstellen.¬† ¬†"},{"title":"Internet vindmodule","img":"https://infofrankrijk.tempurl.host/wp-content/uploads/2025/12/internetfinder-scaled.png","text":"<b>Korte, beschrijving van de tool:</b>\n\n‚Ä¢ Dit is een interactieve adres-checker die in twee stappen toont of glasvezel of DSL op uw locatie beschikbaar is.\n‚Ä¢ Directe doorlinks naar de belangrijkste Franse glasvezel-providers en aanvullende diensten voor Orange Fibre, SFR Fibre, Bouygues Fibre en Free Fibre.\n‚Ä¢ Praktische extra tips (linkjes) voor Nederlandse NLZIET, Canal Digitaal, en VPN-bescherming via NordVPN en Surfshark.\n"},{"title":"Bruto naar netto in FR | BE | NL","img":"https://infofrankrijk.tempurl.host/wp-content/uploads/2025/12/bruto-netto-calculator-scaled.png","text":"<b>Inkomensanalyse: bruto/netto simulator.</b>\n\nVergelijk je netto-inkomsten in Frankrijk met Nederland of Belgi√´.\n\nHet Franse belastingsysteem verschilt in menig opzicht van wat u gewend bent. Deze vergelijkingstool biedt een eerste ori√´ntatie op uw netto inkomen na emigratie.\n\n<b>Wat levert het op?</b>\n\n‚Ä¢ De tool berekent een globale indicatie van uw netto inkomen in Frankrijk versus uw thuisland. U krijgt inzicht in de belangrijkste verschillen: sociale premies, belastingschijven en het Franse gezinsquoti√´nt.\n‚Ä¢ Dit is geen exacte berekening maar een degelijke basis voor verdere planning. Met deze eerste inschatting kunt u gerichter in gesprek met uw accountant of belastingadviseur.\n\n<b>Voor wie?</b>\nNederlanders en Belgen die overwegen in Frankrijk te gaan werken of ondernemen. De tool houdt rekening met gezinssituatie en geeft een realistisch beeld van de financi√´le consequenties van emigratie."},{"title":"Nieuwsbrief en videocalls","img":"https://infofrankrijk.tempurl.host/wp-content/uploads/2025/12/nieuwsbrief.png","text":"<b>Ben je abonnee? </b>\n\n‚Ä¢ Dan krijg je automatisch onze nieuwsbrief met updates en aankondigingen van nieuwe tools. \n‚Ä¢ Iedere 2 √† 3 maanden brengen we je op de hoogte van de laatste ontwikkelingen. \n‚Ä¢ Neem deel aan de videoconferenties om je wensen kenbaar te maken. "},{"title":"Handige assistent Franse taal","img":"https://infofrankrijk.tempurl.host/wp-content/uploads/2025/12/taalassistent-scaled.png","text":"<b>DIT IS GEEN CURSUS!</b>\n\nHet is een <b>VERTALER/TOLK</b> die je altijd bij je hebt. Een tool waarmee je per situatie (scenario) een vocabulaire en voorbeeldzinnen krijgt aangereikt die je helpen om de juiste dingen te zeggen. En, we hebben deze tool zo gemaakt dat je deze makkelijk op je telefoon kunt zetten. \n\n<b>Op dit moment zijn er 14 hoofdscenario's:</b>\n\n1. <b>SHOPPING</b>: met meer dan 10 WINKELSOORTEN van 'Boucherie' tot 'Traiteur'\n2. <b>TELEFOON</b>: 9 situaties zoals bellen, opnemen, nummer (ook je eigen nummer) uitspreken enz.\n3. <b>FINANCIEEL</b>: bank & betalen, rekening openen, RIB, incasso‚Äôs, limieten, kaart/contactloos enz. \n4. <b>HUISHOUDEN</b>: van ongediertebestrijding tot zwembad, bedenk het maar...\n5. <b>LA MAIRIE</b>: met 4 situaties die je daar kunt tegenkomen\n6. <b>GEZONDHEIDSZORG</b>: van huisarts tot apotheek \n\n...¬† en zo verder tot <b>14</b> hoofdscenario's en - per scenario- een veelvoud aan de vocabulaire en voorbeeldzinnen die handig van pas kunnen komen. En natuurlijk gaan we de taalassistent verder uitbouwen in 2026, kom maar op met je wensen en idee√´n!"},{"title":"Offici√´le instellingen / postcode (75005)","img":"https://infofrankrijk.tempurl.host/wp-content/uploads/2025/12/dasboard-admin.png","text":"<b>Vind direct lokale Franse overheidsdiensten. </b>\n\n‚Ä¢ VOER JE FRANSE POSTCODE IN.\n‚Ä¢ CONTACTGEVENS VAN DE MEESTE ADMINISTRATIEVE DIENSTEN:\n\n<i>[ CAF - CPAM - PR√âFECTUUR - MAIRIE - URRSAF - DGFIP - DDT/DDTM - POLICE/COMMISSARIAT - GENDARMERIE - H√îPITAL - P√îLE EMPLOI - TR√âSORERIE - FRANCE SERVICE ]</i>\n\n<b>Bij jou in de buurt natuurlijk !</b>"}],"table":[{"type":"header","name":"Algemeen"},{"type":"item","name":"Infofrankrijk; de basis (vele artikelen)","vis":true,"sub":true},{"type":"item","name":"Dagelijkse nieuwsbrief (gerenoveerd in 2026!)","link":"https://infofrankrijk.tempurl.host/nieuwsbrief/","vis":true,"sub":true},{"type":"item","name":"Het forum van Nederlanders.fr blijft gratis","vis":true,"sub":true},{"type":"header","name":"DOSSIERS"},{"type":"item","name":"Ondernemen in Frankrijk","vis":true,"sub":true},{"type":"item","name":"Vastgoedbezit in Frankrijk","vis":true,"sub":true},{"type":"item","name":"85 PDF bestanden uit 'Klussen in Frankrijk'","link":"https://infofrankrijk.tempurl.host/2025/08/26/klussen/","vis":true,"sub":true},{"type":"item","name":"De gratis Klussen in Frankrijk Module","link":"https://infofrankrijk.tempurl.host/2025/11/30/uit-het-klusforum-van-infofrankrijk-com/","vis":true,"sub":true},{"type":"header","name":"Bij u in de buurt"},{"type":"item","name":"Internet beschikbaarheid","link":"https://infofrankrijk.tempurl.host/2025/11/12/internet/","vis":true,"sub":true},{"type":"item","name":"Overheden en instellingen","link":"https://infofrankrijk.tempurl.host/2025/11/14/overheden/","vis":true,"sub":true},{"type":"item","name":"Contr√¥le Technique | APK - Postcode","link":"https://infofrankrijk.tempurl.host/2025/11/26/de-controle-technique-de-franse-apk/","vis":true,"sub":true},{"type":"item","name":"Internet bij jouw huis in Frankrijk","link":"https://infofrankrijk.tempurl.host/2025/11/12/internetverbinding-in-frankrijk/","vis":true,"sub":true},{"type":"header","name":"SIMULATIE- EN REKENMODULES"},{"type":"item","name":"Periodieke nieuwsbrief & nieuwe tools","vis":false,"sub":true},{"type":"item","name":"Zorgkompas Frankrijk: simulator","link":"https://infofrankrijk.tempurl.host/2025/11/21/zorgkompas/","vis":false,"sub":true},{"type":"item","name":"Database onroerend goed zoeken","vis":false,"sub":true},{"type":"item","name":"Bruto-Netto simulator NL <> FR","link":"https://infofrankrijk.tempurl.host/2025/11/10/financieel/","vis":false,"sub":true},{"type":"item","name":"Simulatiemodule Energieverbruik","link":"https://infofrankrijk.tempurl.host/2025/09/22/energie/","vis":false,"sub":true},{"type":"item","name":"Beroepenchecker","link":"https://infofrankrijk.tempurl.host/2025/11/20/werken/","vis":false,"sub":true},{"type":"item","name":"Plus-Value-Calculator","link":"https://infofrankrijk.tempurl.host/2025/11/08/plus-value-calculator/","vis":false,"sub":true}]};

let appData = JSON.parse(JSON.stringify(defaultData));

/* INIT & TABS */
function init() {
    const saved = localStorage.getItem('if_v21_data');
    if(saved) appData = JSON.parse(saved);
    renderTiles();
    renderTable();
    updateExportArea();
}

function switchTab(id) {
    document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
    document.querySelectorAll('.tab').forEach(el => el.classList.remove('active'));
    document.getElementById('tab-'+id).classList.add('active');
    event.target.classList.add('active');
}

function showToast(msg, type="success") {
    const x = document.getElementById("toast");
    x.innerText = msg;
    x.className = "show " + type;
    setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
}

function saveData() {
    localStorage.setItem('if_v21_data', JSON.stringify(appData));
    updateExportArea();
}

/* FORMAT TEXT HELPER */
function formatText(command) {
    const textarea = document.getElementById('tileText');
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const text = textarea.value;
    const selected = text.substring(start, end);
    let replacement = "";

    if (command === 'bold') replacement = `<b>${selected}</b>`;
    if (command === 'italic') replacement = `<i>${selected}</i>`;
    if (command === 'list') replacement = `\n‚Ä¢ ${selected}`;

    textarea.value = text.substring(0, start) + replacement + text.substring(end);
    textarea.focus();
    textarea.selectionEnd = start + replacement.length;
}

/* TILES LOGIC */
function addTile() {
    const title = document.getElementById('tileTitle').value;
    const img = document.getElementById('tileImg').value;
    const text = document.getElementById('tileText').value;

    if(!title) { showToast("Vul minstens een titel in!", "error"); return; }

    appData.tiles.push({
        title: title,
        img: img || "https://via.placeholder.com/600x350/eee/800000?text=Geen+Afbeelding",
        text: text
    });
    
    document.getElementById('tileTitle').value = "";
    document.getElementById('tileImg').value = "";
    document.getElementById('tileText').value = "";
    
    renderTiles();
    saveData();
    showToast("‚úÖ Tegel toegevoegd!");
}

function loadTileToEdit(idx) {
    const t = appData.tiles[idx];
    document.getElementById('tileTitle').value = t.title;
    document.getElementById('tileImg').value = t.img;
    document.getElementById('tileText').value = t.text;
    
    if(confirm("Bewerken: '" + t.title + "'?\nDe oude wordt verwijderd zodra je op 'Opslaan' klikt.")) {
        appData.tiles.splice(idx, 1);
        renderTiles();
        window.scrollTo(0,0);
        showToast("‚úèÔ∏è Gegevens ingeladen in formulier");
    }
}

function deleteTile(idx) {
    if(confirm("Weet je zeker dat je deze tegel wilt verwijderen?")) {
        appData.tiles.splice(idx, 1);
        renderTiles();
        saveData();
        showToast("üóëÔ∏è Tegel verwijderd");
    }
}

function renderTiles() {
    const list = document.getElementById('tileList');
    list.innerHTML = "";
    appData.tiles.forEach((t, i) => {
        // Voor preview in admin gebruiken we ook een simpele replace voor enters
        const previewText = t.text.replace(/\n/g, '<br>');
        list.innerHTML += `
            <div class="tile-card" onclick="loadTileToEdit(${i})" style="cursor:pointer;" title="Klik om te bewerken">
                <div class="edit-hint">‚úé Klik om te bewerken</div>
                <div class="tile-img" style="background-image:url('${t.img}')"></div>
                <div class="tile-body">
                    <div class="tile-title">${t.title}</div>
                    <div class="tile-text">${previewText}</div>
                    <button class="btn btn-danger" style="margin-top:auto; z-index:10;" onclick="event.stopPropagation(); deleteTile(${i})">Verwijderen</button>
                </div>
            </div>`;
    });
}

/* TABLE LOGIC */
function addTableRow() {
    const type = document.getElementById('rowType').value;
    const name = document.getElementById('rowName').value;
    if(!name) { showToast("Vul een naam in!", "error"); return; }
    
    const row = { type, name };
    if(type === 'item') {
        row.link = document.getElementById('rowLink').value;
        row.vis = document.getElementById('visCheck').checked;
        row.sub = document.getElementById('subCheck').checked;
    }
    appData.table.push(row);
    
    document.getElementById('rowName').value = "";
    document.getElementById('rowLink').value = "";
    renderTable();
    saveData();
    showToast("‚úÖ Regel toegevoegd");
}

function deleteRow(idx) {
    if(confirm("Regel verwijderen?")) { appData.table.splice(idx, 1); renderTable(); saveData(); showToast("üóëÔ∏è Regel verwijderd"); }
}

function moveRow(idx, dir) {
    const newIdx = idx + dir;
    if(newIdx >= 0 && newIdx < appData.table.length) {
        [appData.table[idx], appData.table[newIdx]] = [appData.table[newIdx], appData.table[idx]];
        renderTable();
        saveData();
    }
}

function renderTable() {
    const list = document.getElementById('tableList');
    list.innerHTML = "";
    appData.table.forEach((r, i) => {
        let html = "";
        if(r.type === 'header') {
            html = `<tr class="table-header-row"><td colspan="3">${r.name}</td>`;
        } else {
            let link = r.link ? `<span style="font-size:0.8em; color:#3498db;">(link)</span>` : '';
            html = `<tr>
                <td>${r.name} ${link}</td>
                <td align="center">${r.vis ? '<span class="check-yes">‚úî</span>' : '<span class="check-no">‚úò</span>'}</td>
                <td align="center">${r.sub ? '<span class="check-yes">‚úî</span>' : '<span class="check-no">‚úò</span>'}</td>`;
        }
        html += `<td align="center">
            <button class="btn btn-action" onclick="moveRow(${i}, -1)">‚Üë</button>
            <button class="btn btn-action" onclick="moveRow(${i}, 1)">‚Üì</button>
            <button class="btn btn-danger" onclick="deleteRow(${i})">√ó</button>
        </td></tr>`;
        list.innerHTML += html;
    });
}

/* BACKUP */
function updateExportArea() { document.getElementById('exportArea').value = JSON.stringify(appData); }
function copyExport() { document.getElementById('exportArea').select(); document.execCommand('copy'); showToast("üìã Data gekopieerd!"); }
function importData() {
    const txt = document.getElementById('importArea').value.trim();
    if(!txt) { showToast("Plak eerst code!", "error"); return; }
    try { appData = JSON.parse(txt); renderTiles(); renderTable(); saveData(); showToast("‚úÖ Data hersteld!"); } catch(e) { alert("Fout: Ongeldige JSON."); }
}
function resetToDefault() { if(confirm("Resetten naar standaard?")) { appData = JSON.parse(JSON.stringify(defaultData)); renderTiles(); renderTable(); saveData(); showToast("üîÑ Reset voltooid"); } }

/* =========================================================
   DE GENERATOR ENGINE (V20 - Fixed Height, Scroll & Buttons)
   ========================================================= */
function generateCode(mode) {
    
    // 1. TILES GENERATION 
    let tilesHTML = '';
    if(mode === 'all' || mode === 'tiles') {
        tilesHTML = '<div class="if-grid">';
        appData.tiles.forEach((t, index) => {
            const processedText = t.text.replace(/\n/g, '<br>');
            
            tilesHTML += `
            <div class="if-card">
                <div class="if-card-img" style="background-image:url('${t.img}')"></div>
                <div class="if-card-content">
                    <h3>${t.title}</h3>
                    <div class="if-text-scroll">
                        <p>${processedText}</p>
                    </div>
                    <div class="if-card-actions">
                        <a href="https://infofrankrijk.tempurl.host/abonnement/" class="if-btn-mini if-btn-red" target="_blank">Word abonnee</a>
                        <a href="https://infofrankrijk.tempurl.host/inloggen/" class="if-btn-mini if-btn-link" target="_blank">Log in</a>
                    </div>
                </div>
            </div>`;
        });
        tilesHTML += '</div>';
    }

    // 2. TABLE GENERATION
    let tableHTML = '';
    if(mode === 'all' || mode === 'table') {
        tableHTML = '<table class="if-tbl"><thead><tr><th class="tl">DIENST / INSTRUMENT</th><th>BEZOEKER</th><th>ABONNEE</th></tr></thead><tbody>';
        appData.table.forEach(r => {
            if(r.type === 'header') {
                tableHTML += `<tr><td colspan="3" class="if-th">${r.name}</td></tr>`;
            } else {
                let linkHTML = r.link ? `<a href="${r.link}" target="_blank" class="if-link-icon"><svg viewBox="0 0 24 24"><path d="M14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3m-2 16H5V5h7V3H5c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2v-7h-2v7z"/></svg></a>` : '';
                tableHTML += `<tr><td class="if-td-name">${r.name}${linkHTML}</td><td class="if-icon">${r.vis?'<span class="c-yes">‚úî</span>':'<span class="c-no">‚úò</span>'}</td><td class="if-icon bg-sub">${r.sub?'<span class="c-yes">‚úî</span>':'<span class="c-no">‚úò</span>'}</td></tr>`;
            }
        });
        tableHTML += `<tr><td style="font-weight:bold; color:#800000;">KOSTEN</td><td style="text-align:center;">Gratis</td><td style="text-align:center; font-weight:bold; color:#800000; background:#fffbfc;">‚Ç¨49 / jaar</td></tr></tbody></table>`;
        if(mode !== 'all') {
             tableHTML += `<div style="text-align:center; margin-top: 30px;"><a href="https://infofrankrijk.tempurl.host/abonnement/" class="if-btn" style="display:block; max-width:400px; margin:0 auto; padding: 15px; font-size: 18px;">Word abonnee, meld je aan</a></div>`;
        }
    }

    // 3. MASTER CSS
    // Let op de nieuwe classes voor de scrollbar en mini-knoppen
    let css = `<style>.if-onboard{font-family:'Segoe UI',Tahoma,sans-serif;max-width:900px;margin:0 auto;color:#333;line-height:1.5}.if-onboard *{box-sizing:border-box}.if-btn-row{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:30px}.if-btn{flex:1 1 200px;text-align:center;padding:12px 15px;background:#800000;color:white!important;text-decoration:none;border-radius:4px;font-weight:600;font-size:16px;border:1px solid #800000;cursor:pointer;transition:0.2s;font-family:inherit;display:inline-block}.if-btn:hover{background:#600000;transform:translateY(-1px)}.if-btn-gray{background:#555;border-color:#555}.if-btn-gray:hover{background:#333}.if-hidden{display:none!important}.if-visible{display:block!important;animation:ifSlideDown 0.5s ease-out}@keyframes ifSlideDown{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.if-grid{display:grid!important;grid-template-columns:repeat(auto-fit,minmax(45%,1fr))!important;gap:20px!important;margin-bottom:30px}@media(max-width:650px){.if-grid{grid-template-columns:1fr!important}}.if-card{border:1px solid #eee;border-radius:8px;overflow:hidden;background:white;box-shadow:0 4px 6px rgba(0,0,0,0.05);display:flex;flex-direction:column;height:550px}.if-card-img{height:160px;background-size:cover;background-position:top center;background-color:#f9f9f9;border-bottom:1px solid #eee;flex-shrink:0}.if-card-content{padding:20px;flex-grow:1;display:flex;flex-direction:column;background:rgba(128,0,0,0.04);overflow:hidden}.if-card-content h3{color:#800000;margin:0 0 10px 0;font-size:1.1em;line-height:1.3;font-weight:700;flex-shrink:0}.if-text-scroll{flex-grow:1;overflow-y:auto;padding-right:5px;margin-bottom:15px;font-size:0.95em;color:#555}.if-text-scroll p{margin:0 0 10px 0}.if-text-scroll::-webkit-scrollbar{width:4px}.if-text-scroll::-webkit-scrollbar-track{background:#f1f1f1}.if-text-scroll::-webkit-scrollbar-thumb{background:#800000;border-radius:2px}.if-card-actions{flex-shrink:0;display:flex;justify-content:space-between;align-items:center;border-top:1px solid rgba(0,0,0,0.1);padding-top:15px}.if-btn-mini{text-decoration:none;font-size:0.9em;font-weight:600;padding:6px 12px;border-radius:3px;transition:0.2s}.if-btn-red{background:#800000;color:white!important}.if-btn-red:hover{background:#600000}.if-btn-link{color:#666!important;background:none}.if-btn-link:hover{text-decoration:underline;color:#333!important}.if-tbl{width:100%;border-collapse:collapse;margin-bottom:30px;border:1px solid #eee;font-size:15px}.if-tbl th{background:white;color:#800000;padding:15px;text-align:center;border-bottom:3px solid #800000;font-size:16px;text-transform:uppercase}.if-tbl th.tl{text-align:left;width:50%}.if-tbl td{padding:12px 10px;border-bottom:1px solid #eee;vertical-align:middle}.if-th{background:#f2f2f2;color:#800000;font-weight:bold;text-transform:uppercase;font-size:14px;letter-spacing:1px;padding:15px!important}.if-icon{text-align:center;font-size:18px}.bg-sub{background-color:#fffbfc}.c-yes{color:#27ae60;font-weight:bold}.c-no{color:#ccc}.if-link-icon svg{width:14px;height:14px;fill:#800000;margin-left:5px;opacity:0.6;vertical-align:middle}.if-h1{color:#800000;font-size:28px;font-weight:700;margin:0 0 10px 0}.if-intro{font-size:18px;color:#555;margin:0 0 25px 0}</style>`;
    
    // 4. OUTPUT HTML
    let outputHTML = '';
    
    if(mode === 'all') {
        outputHTML = `<div class="if-onboard"><h1 class="if-h1">Direct toegang nodig?</h1><p class="if-intro">Voor dit instrument is een Infofrankrijk abonnement vereist.</p><div class="if-btn-row"><a href="https://infofrankrijk.tempurl.host/abonnement/" class="if-btn">Word abonnee, meld je aan</a><a href="https://infofrankrijk.tempurl.host/aanmelden" class="if-btn">Log in</a><button onclick="var el=document.getElementById('if-fold-1');if(el.classList.contains('if-hidden')){el.classList.remove('if-hidden');el.classList.add('if-visible');this.innerText='Sluit overzicht';}else{el.classList.remove('if-visible');el.classList.add('if-hidden');this.innerText='De voordelen van een abonnement';}" class="if-btn">De voordelen van een abonnement</button></div><div id="if-fold-1" class="if-hidden"><h2 style="color:#800000; margin-bottom: 20px;">Wat krijg je als abonnee?</h2>${tilesHTML}<div style="text-align:center; padding: 20px 0; border-top: 1px solid #eee;"><button onclick="var el=document.getElementById('if-fold-2');if(el.classList.contains('if-hidden')){el.classList.remove('if-hidden');el.classList.add('if-visible');this.innerText='Verberg tabel';}else{el.classList.remove('if-visible');el.classList.add('if-hidden');this.innerText='Bekijk de vergelijkingstabel';}" class="if-btn if-btn-gray" style="max-width:300px;">Bekijk de vergelijkingstabel</button></div></div><div id="if-fold-2" class="if-hidden"><h2 style="color:#800000; margin-top: 30px;">Gratis vs. Abonnee</h2>${tableHTML}<div style="text-align:center; margin-top: 30px;"><a href="https://infofrankrijk.tempurl.host/abonnement/" class="if-btn" style="display:block; max-width:400px; margin:0 auto; padding: 15px; font-size: 18px;">Word abonnee, meld je aan</a></div></div></div>`;
    } 
    else if(mode === 'tiles') {
        outputHTML = `<div class="if-onboard">${tilesHTML}</div>`;
    } 
    else if(mode === 'table') {
        outputHTML = `<div class="if-onboard">${tableHTML}</div>`;
    }

    const out = document.getElementById('finalCode');
    out.value = css + outputHTML;
    out.select();
    document.execCommand('copy');
    showToast("‚úÖ Code gekopieerd! Plak in 'Tekst' tab van WP.");
}

init();
</script>

</body>
</html>
